# 进程

## fork/getpid/getppid

`pid_t fork(void);`

该函数被执行两次，父子进程各执行一次。子进程返回0，表示子进程创建成功，父进程返回创建的子进程的id。返回-1表示创建子进程失败。

`pid_t getpid(void);`

获取当前进程id

`pid_t getppid(void);`

获取当前进程的父进程id



```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
    printf("Before call fork method.\n");
    printf("Before call fork method..\n");
    printf("Before call fork method...\n");
    printf("Before call fork method....\n");

    pid_t pid = fork();
    if(pid == -1)
    {
        perror("create child process faild！");
        exit(EXIT_FAILURE);
    }
    else if(pid == 0)
    {
        printf("I'm child process.\n");
    }
    else if(pid > 0)
    {
        printf("I'm parent process, my child process id is %d\n", pid);
    }

    // 下面的语句父子进程都将执行
    pid_t my_pid = getpid();
    pid_t my_ppid = getppid();
    printf("my_pid = %d, my_ppid = %d\n", my_pid, my_ppid);

    printf("Demo 演示结束！\n");

    exit(EXIT_SUCCESS);
}
```

循环创建5个子进程

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
    int i;
    for(i = 0; i < 5; i++)
    {
        if(fork() ==0 )
        {
            // 子进程这里需要退出，否则子进程执行循环进来又会创建子进程
            break;
        }
    }
    if(i == 5)
    {
        sleep(1);
        printf("I'm parent process.\n");
    }
    else
    {
        printf("I'm %dth child process.\n", i + 1);
    }
    exit(EXIT_SUCCESS);
}
```

